# 文件自动分类工具

## 项目简介

文件自动分类工具是一款基于AI大语言模型的智能文件管理工具，支持按部门归属和保管期限进行双维度分类。通过自动化识别文件内容关键词，结合预设的分类规则，实现文件的智能分类与归档，提升档案管理的规范化水平。

## 功能特性

### 🎯 核心功能
- **多维度分类**: 支持按部门归属（办公室、人力资源部等）和保管期限（永久/长期/短期）双维度分类
- **AI智能识别**: 基于豆包/DeepSeek大语言模型，智能分析文件内容进行分类
- **规则自定义**: 提供分类规则设置功能，用户可根据实际业务需求修改部门/期限匹配规则
- **多API支持**: 兼容豆包和DeepSeek大语言模型，支持灵活切换API类型

### 🖥️ 用户界面
- **可视化操作**: 提供文件列表可视化展示、实时分类日志输出、操作状态提示等交互功能
- **进度显示**: 实时显示分类进度和状态信息
- **配置持久化**: 自动保存API Key、分类规则等配置，避免重复设置

### 📁 文件管理
- **批量处理**: 支持批量分类文件和文件夹
- **日志记录**: 自动生成分类日志，记录处理过程和结果
- **错误处理**: 完善的异常处理机制，确保程序稳定运行

## 技术架构

### 技术栈
- **后端框架**: Python 3.8+
- **GUI框架**: Tkinter
- **AI模型**: 豆包API / DeepSeek API
- **配置管理**: JSON配置文件
- **日志系统**: Loguru

### 项目结构
```
文件分类工具/
├── main.py                 # 原始版本主程序 (V1.41)
├── main_optimized.py       # 优化版本主程序 (V2.0)
├── run.py                  # 启动脚本
├── requirements.txt        # 依赖包列表
├── README.md              # 项目文档
├── config.py              # 配置管理模块
├── logger.py              # 日志管理模块
├── api_service.py         # API服务模块
├── file_processor.py      # 文件处理模块
├── ui_components.py       # UI组件模块
├── test_app.py            # 测试文件
├── config.json            # 配置文件（自动生成）
├── rules.txt              # 分类规则文件（自动生成）
└── logs/                  # 日志目录（自动生成）
```

## 安装与使用

### 环境要求
- Python 3.8 或更高版本
- Windows 10/11 操作系统

### 安装步骤

1. **克隆或下载项目**
   ```bash
   git clone <项目地址>
   cd 文件分类工具
   ```

2. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   # 运行优化版本（推荐）
   python run.py
   
   # 或直接运行优化版本
   python main_optimized.py
   
   # 运行原始版本
   python run.py -o
   
   # 运行测试
   python run.py -t
   ```

### 使用说明

#### 首次使用
1. 启动程序后，点击「设置→API Key设置」
2. 选择API类型（豆包或DeepSeek）
3. 输入对应的API Key并测试连接
4. 配置会自动保存，下次启动无需重复设置

#### 基本操作
1. **选择文件夹**: 点击「开始→打开文件夹」选择需要分类的目录
2. **开始分类**: 确认文件列表后，点击「开始→开始分类」启动分类流程
3. **查看结果**: 分类完成后，文件会按部门和时间期限自动归类到对应文件夹

#### 自定义规则
1. 点击「设置→分类规则设置」
2. 在弹出窗口中编辑分类规则
3. 点击保存，规则会自动保存到本地文件

## 配置说明

### API配置
- **豆包API**: 需要在火山引擎平台申请API Key
- **DeepSeek API**: 需要在DeepSeek开发者平台申请API Key
- 配置文件位置: `config.json`

### 分类规则
- 支持自定义部门识别规则和保管期限规则
- 规则文件位置: `rules.txt`
- 修改后自动保存，下次启动自动加载

## 常见问题

### Q: 为什么文件没被分类？
A: 可能是API识别失败或文件名无法匹配规则，可检查API Key或手动分类

### Q: 如何修改API Key？
A: 点击「设置→API Key设置」进行修改

### Q: 如何修改分类规则？
A: 点击「设置→分类规则设置」，在弹出窗口中编辑规则后点击保存即可

### Q: 修改的分类规则下次打开软件会保留吗？
A: 会保留，修改的规则会自动保存到与工具同目录的rules.txt文件，下次启动自动加载最新规则

## 开发计划

### 已实现功能
- ✅ 基础文件分类功能
- ✅ 双API支持（豆包/DeepSeek）
- ✅ 自定义分类规则
- ✅ 配置持久化
- ✅ 实时日志显示
- ✅ 进度条显示

### V2.0 优化完成
- ✅ 代码架构重构（模块化设计）
- ✅ 性能优化（异步处理和批量操作）
- ✅ 用户体验改进（现代化UI组件）
- ✅ 错误处理完善（结构化日志记录）
- ✅ 配置管理优化（Pydantic验证）
- ✅ 单元测试添加
- ✅ 文档完善
- ✅ 启动脚本（多版本支持）

## 技术支持

- **开发者**: 史智阳
- **联系邮箱**: 562052228@qq.com
- **版权声明**: 本软件为内部使用工具，未经授权不得商用

## 更新日志

### V2.0 (2025-01-XX) - 优化版本
- **代码架构重构**：采用模块化设计，将功能拆分为独立模块
- **性能优化**：支持异步处理和批量操作，提升处理效率
- **用户体验改进**：现代化UI组件，更好的交互体验
- **错误处理完善**：使用Loguru进行结构化日志记录
- **配置管理优化**：使用Pydantic进行配置验证和管理
- **单元测试**：添加完整的测试套件
- **启动脚本**：提供多版本支持和便捷启动方式

### V1.41 (2025-06-10)
- 新增开发目的菜单
- 优化开发目的文档排版

### V1.4 (2025-06-10)
- 修复API配置保存问题
- 完善配置持久化逻辑
- 优化配置读写稳定性

### V1.3 (2025-06-10)
- 新增DeepSeek API支持
- 优化API设置界面
- 增强API测试功能

### V1.2 (2025-06-09)
- 新增实时日志显示
- 优化分类规则设置界面
- 修复部门子目录创建权限错误
- 新增分类规则持久化功能

### V1.1 (2025-06-09)
- 新增分类规则自定义功能
- 支持文件/文件夹类型显示
- 增强API调试日志
- 优化分类逻辑

### V1.0 (2025-06-09)
- 实现基本分类功能 