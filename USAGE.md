# 文件自动分类工具使用指南

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行程序
```bash
# 推荐：运行优化版本
python run.py

# 或直接运行优化版本
python main_optimized.py

# 运行原始版本
python run.py -o
```

### 3. 首次配置
1. 启动程序后，点击「设置→API配置」
2. 选择API类型（豆包或DeepSeek）
3. 输入对应的API密钥
4. 点击「测试连接」验证配置
5. 点击「保存配置」

## 详细使用说明

### 基本操作流程

#### 第一步：选择文件夹
1. 点击「文件→打开文件夹」或工具栏的「📁 打开文件夹」按钮
2. 选择包含需要分类文件的文件夹
3. 程序会自动扫描文件夹中的文件和子文件夹
4. 文件列表会显示在界面上

#### 第二步：开始分类
1. 确认文件列表无误后，点击「文件→开始分类」或工具栏的「🚀 开始分类」按钮
2. 程序会显示进度对话框，实时显示处理进度
3. 每个文件会通过AI进行智能分类
4. 分类完成后，文件会自动移动到对应的分类文件夹

#### 第三步：查看结果
1. 分类完成后，文件会按以下结构组织：
   ```
   源文件夹/
   ├── 永久/
   │   ├── 办公室（党委办公室、党委工作部）/
   │   ├── 人力资源部（党委组织部）/
   │   └── ...
   ├── 长期/
   │   ├── 财务资金部/
   │   └── ...
   └── 短期/
       ├── 各部门通用归档范围/
       └── ...
   ```

### 配置说明

#### API配置
- **豆包API**：需要在火山引擎平台申请API Key
- **DeepSeek API**：需要在DeepSeek开发者平台申请API Key
- 配置会自动保存到`config.json`文件

#### 分类规则设置
1. 点击「设置→分类规则」
2. 在文本编辑器中修改分类规则
3. 点击「保存规则」保存修改
4. 规则会自动保存到`rules.txt`文件

### 高级功能

#### 导出结果
1. 分类完成后，点击「文件→导出结果」
2. 选择保存位置和文件名
3. 程序会生成详细的分类报告，包含：
   - 处理统计信息
   - 每个文件的分类结果
   - 处理时间和错误信息

#### 日志查看
- 程序运行日志保存在`logs/`目录下
- `classification.log`：一般日志
- `error.log`：错误日志

### 常见问题解决

#### 问题1：API连接失败
**症状**：测试连接时显示失败
**解决方案**：
1. 检查API密钥是否正确
2. 确认网络连接正常
3. 检查API服务是否可用
4. 确认账户余额充足

#### 问题2：文件分类不准确
**症状**：文件被错误分类或未分类
**解决方案**：
1. 检查分类规则是否合适
2. 尝试修改文件名使其更符合规则
3. 检查API返回结果是否正常

#### 问题3：程序运行缓慢
**症状**：分类过程很慢
**解决方案**：
1. 检查网络连接速度
2. 减少同时处理的文件数量
3. 使用更快的API服务

#### 问题4：配置文件丢失
**症状**：程序启动时提示配置错误
**解决方案**：
1. 重新配置API设置
2. 检查文件权限
3. 确保程序有写入权限

### 最佳实践

#### 文件命名建议
- 使用清晰、描述性的文件名
- 包含关键词，如"财务报告"、"人事档案"等
- 避免使用过于简短的名称

#### 分类规则优化
- 根据实际业务需求调整规则
- 定期更新和维护分类规则
- 测试新规则的效果

#### 备份策略
- 分类前备份重要文件
- 定期备份配置文件
- 保存分类结果报告

### 命令行选项

```bash
# 显示帮助信息
python run.py --help

# 运行优化版本（默认）
python run.py

# 运行原始版本
python run.py -o

# 运行测试
python run.py -t
```

### 技术支持

如果遇到问题，可以：
1. 查看程序日志文件
2. 检查常见问题解决方案
3. 联系开发者：562052228@qq.com

### 版本说明

- **V2.0（优化版本）**：推荐使用，功能更完善，性能更好
- **V1.41（原始版本）**：保留用于兼容性

建议使用V2.0优化版本以获得最佳体验。 